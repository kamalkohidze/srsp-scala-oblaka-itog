<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ–π To-Do List –Ω–∞ Scala</title>
    <style>
        /* –í—Å–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è —Ç–∞–∫–∏–º–∏ –∂–µ, –¥–æ–±–∞–≤–ª—é —Ç–æ–ª—å–∫–æ –±–µ–π–¥–∂ */
        /* ... –∫–æ–ø–∏—Ä—É–π –≤—Å–µ —Å—Ç–∏–ª–∏ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Ñ–∞–π–ª–∞ ... */

        .tech-badge {
            text-align: center;
            margin-bottom: 30px;
        }

        .tech-badge span {
            display: inline-block;
            padding: 5px 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 20px;
            font-size: 12px;
            margin: 0 5px;
            font-weight: bold;
        }
    </style>
</head>
<body>
<!-- HTML —Ä–∞–∑–º–µ—Ç–∫–∞ –æ—Å—Ç–∞—ë—Ç—Å—è —Ç–∞–∫–æ–π –∂–µ, –¥–æ–±–∞–≤—å —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ subtitle: -->
<div class="tech-badge">
    <span>‚öôÔ∏è Scala Backend</span>
    <span>üóÑÔ∏è PostgreSQL</span>
    <span>‚òÅÔ∏è Supabase</span>
</div>

<script>
    // –í–ê–ñ–ù–û: –¢–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ–º —á–µ—Ä–µ–∑ Scala API!
    const API_URL = 'http://localhost:8080/api';

    let currentFilter = 'all';
    let editingTodoId = null;
    let allTodos = [];

    async function loadTodos() {
        try {
            document.getElementById('loading').style.display = 'block';
            const response = await fetch(`${API_URL}/todos`);

            if (!response.ok) throw new Error(`–û—à–∏–±–∫–∞: ${response.status}`);

            allTodos = await response.json();
            renderTodos();
            updateStats();
            document.getElementById('loading').style.display = 'none';
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
            document.getElementById('loading').innerHTML = '‚ùå –ù–µ –º–æ–≥—É –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Scala —Å–µ—Ä–≤–µ—Ä—É!<br>–£–±–µ–¥–∏—Å—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 8080';
        }
    }

    async function quickAddTodo() {
        const input = document.getElementById('quickAddInput');
        const title = input.value.trim();

        if (!title) return;

        try {
            const response = await fetch(`${API_URL}/todos`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ title, priority: 'medium' })
            });

            if (!response.ok) throw new Error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è');

            input.value = '';
            await loadTodos();
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞:', error);
            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∑–∞–¥–∞—á–∏!');
        }
    }

    async function toggleTodo(id, completed) {
        try {
            const response = await fetch(`${API_URL}/todos/${id}`, {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ completed })
            });

            if (!response.ok) throw new Error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è');
            await loadTodos();
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞:', error);
        }
    }

    async function deleteTodo(id) {
        if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É –∑–∞–¥–∞—á—É?')) return;

        try {
            const response = await fetch(`${API_URL}/todos/${id}`, {
                method: 'DELETE'
            });

            if (!response.ok) throw new Error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è');
            await loadTodos();
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞:', error);
        }
    }

    async function saveEdit() {
        const title = document.getElementById('editTitle').value.trim();
        const description = document.getElementById('editDescription').value.trim();
        const priority = document.getElementById('editPriority').value;

        if (!title) return;

        try {
            const response = await fetch(`${API_URL}/todos/${editingTodoId}`, {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ title, description, priority })
            });

            if (!response.ok) throw new Error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è');

            closeModal();
            await loadTodos();
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞:', error);
        }
    }

    // –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Å—Ç–∞—é—Ç—Å—è —Ç–∞–∫–∏–º–∏ –∂–µ (renderTodos, filterTodos, openEditModal, closeModal, updateStats)
    // ... –∫–æ–ø–∏—Ä—É–π –∏—Ö –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Ñ–∞–π–ª–∞ ...
</script>
</body>
</html>